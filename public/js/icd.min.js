"use strict";function t(t){var e={ajax:function(t,e,n){var o,i,r,c=new $.Deferred,l=new XMLHttpRequest,s=e;if(n&&("POST"===t||"PUT"===t)){s+="?",o=0;for(i in n)n.hasOwnProperty(i)&&(o++&&(s+="&"),s+=encodeURIComponent(i)+"="+encodeURIComponent(n[i]))}return l.open(t,s,!0),l.send(),r='XHR "'+t+'" url: '+e,l.onload=function(){200==this.status?c.resolve(this.response):(a("ERROR^: "),c.reject(this.statusText))},l.onerror=function(){c.reject(this.statusText)},c.promise()}};return{get:function(n){return e.ajax("GET",t,n)},post:function(n){return e.ajax("POST",t,n)},put:function(n){return e.ajax("PUT",t,n)},"delete":function(n){return e.ajax("DELETE",t,n)}}}function e(t){return document.getElementById(t)}function n(t){return arguments[0]?JSON.parse(t):""}function o(t){return JSON.stringify(t)}function a(){try{return}catch(t){}}function i(t,e){setTimeout(t,e)}function r(){return navigator.onLine}function c(){var t=0;return{count:function(){return t++},reset:function(){t=0}}}function l(t){function e(t){var n,a;if(null!==t&&void 0!==t)switch(typeof t){case"number":o+=8;break;case"string":o+=2*t.length;break;case"boolean":o+=4;break;case"object":if(n=Object.prototype.toString.call(t).slice(8,-1),"Object"===n||"Array"===n)for(a in t)t.hasOwnProperty(a)&&e(t[a]);else o+=2*(""+t).length}return o}function n(t){return 1024>t?t+" bytes":1048576>t?(t/1024).toFixed(3)+" KiB":1073741824>t?(t/1048576).toFixed(3)+" MiB":(t/1073741824).toFixed(3)+" GiB"}var o=0;return n(e(t))}function s(){H(),r()?q():z()}function u(){var t=location.pathname;$("ul.nav a[href]").each(function(){$(this).parents("li").last().removeClass("active")}),$("ul.nav a[href$='"+t+"']").each(function(){$(this).parents("li").last().addClass("active")})}function d(){var t,e,n,o=this;for(t=65;91>t;t++)e=String.fromCharCode(t),n=document.createElement("option"),n.setAttribute("value",e),n.innerHTML=e,o.append(n);return!0}function f(){return $("select.numbers").each(function(){var t,e;for(e=0;10>e;e++)t=document.createElement("option"),t.setAttribute("value",e),t.innerHTML=e,this.appendChild(t)}),!0}function p(){$("body").removeAttr("style"),d.call($("#letter")),f(),v.call($("#catalog1"),Q.classes,"class",0),g(),h(),m(),S()}function h(){return G.width1=$("#catalog-wrapper").width(),$(".list").width(G.width1-2),!0}function m(){return G.width2=$("#autocomplete").outerWidth(),!0}function g(){var t=$("#top_menu").height();return $("#view_content").css("margin-top",t+10),!0}function b(){var t,e,n,o,a,i,r,c,l=$(this).attr("element"),s=$(this).attr("number"),u=[];if(w($(this),l),t=0,e=0,"class"==l||"block"==l)if(n=$(this).attr("l1"),o=$(this).attr("n1"),a=$(this).attr("l2"),i=$(this).attr("n2"),"class"==l){for(r in Q.count["class"]){if(r==n+o+a+i){e=t+Q.count["class"][r];break}t+=Q.count["class"][r]}u=Q.blocks.slice(t,e),v.call($("#catalog2"),u,"block",s)}else{for(r in Q.count.block){if(r==n+o+a+i){e=t+Q.count.block[r];break}t+=Q.count.block[r]}u=Q.nosologies.slice(t,e),v.call($("#catalog3"),u,"nosology",s)}else{if("nosology"!=l)return;c=$(this).attr("l"),o=$(this).attr("n1");for(r in Q.count.nosology){if(r==c+o){e=t+Q.count.nosology[r];break}t+=Q.count.nosology[r]}u=Q.diagnoses.slice(t,e),v.call($("#catalog4"),u,"diagnose",s)}u.length=0,k(l)}function v(t,e,n,o){var a,i,r,c,l,s;switch(a=this.find("ul"),a.empty(),e){case"diagnose":for(i in t)r=t[i].label.replace(/[А]([0-9]{2})/,"A$1").replace(/[В]([0-9]{2})/,"B$1").replace(/[Е]([0-9]{2})/,"E$1").replace(/(\([A-Z][0-9]{2}(\.[0-9]{1}){0,}(\+|\*)\))/,"<button class='iLink btn-sm btn-primary'><b>$1</b></button>"),c=$("<li><b>"+t[i].l+t[i].n1+"."+t[i].n2+"</b> "+r+"</li>"),c.attr({"class":"element list-group-item",element:e,l:t[i].l,n1:t[i].n1,n2:t[i].n2,number:i}),a.append(c);break;case"nosology":for(i in t)l="",Q.count&&(s=Q.count.nosology[t[i].l+t[i].n1],l='<span class="badge pull-right">'+s+"</span>"),c=$("<li>"+l+"<b>"+t[i].l+t[i].n1+"</b>  "+t[i].label+"</li>"),c.attr({"class":"element list-group-item",element:e,l:t[i].l,n1:t[i].n1,number:i}),a.append(c);break;default:for(i in t)l="",Q.count&&(s=Q.count[e][t[i].l1+t[i].n1+t[i].l2+t[i].n2],l='<span class="badge pull-right">'+s+"</span>"),c=$("<li>"+l+"<b>"+t[i].l1+t[i].n1+"-"+t[i].l2+t[i].n2+"</b>  "+t[i].label+"</li>"),c.attr({"class":"element list-group-item",element:e,l1:t[i].l1,n1:t[i].n1,l2:t[i].l2,n2:t[i].n2,number:i}),a.append(c)}return!0}function w(t){if(t&&t.hasClass("element")){var e=t.attr("element");return w[e]=t,t.parent().children(".active").removeClass("active"),t.addClass("active")}}function y(t){var e,n;return t&&"object"==typeof t?(e=t.offset(),screen.width>690?$("html, body").animate({scrollTop:e.top-$(window).height()/2}):$("html, body").scrollTop(e.top-$(window).height()/2)):(n=$("#top_menu").height(),e=$("#catalog").offset(),$(window).scrollTop()+n>e.top&&(screen.width>690?$("html, body").animate({scrollTop:e.top-n}):$("html, body").scrollTop(e.top-n))),!0}function k(t,e){var n;if(t){switch(t){case"class":n=0;break;case"block":n=1;break;case"nosology":n=2;break;case"diagnos":n=3;break;default:n=4}e||n++,n>G.stepCatalog?G.stepCatalog++:G.stepCatalog--}return screen.width>690?$("#catalog").animate({left:-G.width1*G.stepCatalog}):$("#catalog").css("left",-G.width1*G.stepCatalog),$("#catalog").height($("#catalog"+(n+1)).height()),y(e&&w[t]),$(document).trigger("catalogReady"),!0}function C(t){G.stepCatalog=0,t?$("#catalog").animate({left:-G.width1*G.stepCatalog}):$("#catalog").css("left",-G.width1*G.stepCatalog)}function D(){var t,e,n,o=0,a=Q.diagnoses.length;for(Q.concat=[],t=0;Q.nosologies.length>t;t++)for(Q.concat.push(Q.nosologies[t]),e=Q.nosologies[t].l,n=Q.nosologies[t].n1;a>o;){if(Q.diagnoses[o].l!=e||Q.diagnoses[o].n1!=n){if(e>Q.diagnoses[o].l||n>Q.diagnoses[o].n1)break;break}Q.concat.push(Q.diagnoses[o]),o++}}function T(){$(".result").hide(),"-"==$("#letter").val()?$("#result1").show():"-"==$("#number1a").val()||"-"==$("#number1b").val()?$("#result2").show():E("-"==$("#number2").val()?"nosologies":"diagnoses")}function E(t){var e,n,o,a,i,r,c,l;if(n=$("#letter").val(),o=$("#number1a").val()+""+$("#number1b").val(),"nosologies"==t){a=Q.nosologies;for(i in a)a[i].l==n&&a[i].n1==o&&(r="<a class='iLink btn btn-primary'>"+a[i].l+a[i].n1+"</a>",e=r+" "+a[i].label)}else{c=$("#number2").val(),l=Q.diagnoses;for(i in l)l[i].l==n&&l[i].n1==o&&l[i].n2==c&&(r="<a class='iLink btn btn-primary'>"+l[i].l+l[i].n1+"."+l[i].n2+"</a>",e=r+" "+l[i].label)}$("#result0").html(e||"Жодного результату").show()}function S(){var t=0;$("#autocomplete").autocomplete({source:Q.concat,minLength:3,appendTo:"#auto_results",focus:function(t,e){if(3!=t.eventPhase){var n=$(".ui-state-focus").offset();$(window).scrollTop(n.top-$(window).height()/2)}},select:function(t,e){var n=e.item.n2?e.item.l+e.item.n1+"."+e.item.n2:e.item.l+e.item.n1;return $("#result").html('<a class="iLink btn btn-primary">'+n+"</a> "+e.item.label),$("#autocomplete-id").val(e.item.l2),$("#autocomplete-description").html(e.item.n1),$(this).blur(),$(window).scrollTop(0),!1},search:function(){},response:function(){t=0},open:function(){},create:function(e){$(this).data("ui-autocomplete")._renderItem=function(e,n){var o,a,i,r;switch(t){case 3:o="success";break;case 0:o="info";break;case 1:o="warning";break;case 2:o="danger"}return o="list-group-item-"+o,t++,4==t&&(t=0),a=n.l+n.n1,n.n2&&(a+="."+n.n2),i=RegExp("("+this.term+")","i"),r=n.label.replace(i,"<b><u>$1</u></b>"),$("<li>").data("item.autocomplete",n).append("<b>"+a+"</b> "+r).addClass("list-group-item").addClass(n.n2&&"sub").addClass(o).appendTo(e)},$(this).data("ui-autocomplete")._resizeMenu=function(t,e){this.menu.element.width(G.width2-2)}}})}function L(){var t="check";try{return K.setItem(t,t),K.removeItem(t),!0}catch(e){return!1}}function R(){a("??? Check Cache");var t="",e="Ваш бразуер "+t+"підтримує веб-додаток";applicationCache?function(){a(e)}():function(){t="no",a(e)}(),$("#localCheck").append(e)}function x(t,e){return L?(K[t]=o(e),!0):void 0}function j(t){}function _(){}function I(){}function A(e,o,a){it.add(e,o);var i=a||"get",r=new $.Deferred(function(){t(e+".json")[i]().then(function(t){if(o.match(/\./)){var a=o.split(".");window[a[0]]||(window[a[0]]={}),window[a[0]][a[1]]=n(t)}else window[o]=n(t);it.readyFile(e,o),r.resolve()},function(t,e){ot.error(t,e),r.reject()})});return r.promise()}function M(t){}function O(){return $.when(A("public/db/count","ICD.count"),A("public/db/classes","ICD.classes"),A("public/db/blocks","ICD.blocks"),A("public/db/nosologies","ICD.nosologies"),A("public/db/diagnoses","ICD.diagnoses")).then(function(){for(var t in W.ICD.uk)Q[t]=W.ICD.uk[t];x("ICD",Q),p(),D(),it.end()})}function F(){A("public/version","version").then(function(){x("version",W),O()})}function N(){W=n(K.version),Q=n(K.ICD),D()}function P(){var e={roads:{},"delete":function(t){return delete this.roads[t],!0},add:function(t,n){for(var o in t)e.roads[o]={gate:t[o]};return!0},gate:function(t){return e.roads[t].gate},init:function(t){var n,o;t&&"object"==typeof t&&this.add(t),n=location.pathname.slice(),o=e.gate(n),e.loadPage(o,n)},controller:function(t,n){return t&&"string"==typeof t&&n?"function"==typeof n?(this.roads[t].controller=n,!0):!1:("function"==typeof e.roads[t].controller&&e.roads[t].controller(),!0)},url2obj:function(t){var e,n,o;return e="#/"==t.substr(0,2)?t.substr(2):t,n=e.split(/&/),o={},$.each(n,function(){var t=this.split(/=/);o[t[0]]=t[1]}),o},loadPage:function(n,o){var a=this.url2obj(n),i=$("#view_content");t(n).get(a).then(function(t){i.html(t),e.controller(o)},function(t){i.text("ERROR: "+t)}).then(function(t){})}};return{init:function(t){return e.init(t)},path:function(t){return{add:function(t){return e.add(t,e)},"delete":function(t){return e["delete"](t)},gate:function(t){return e.gate(t)}}},controller:function(t,n){return e.controller(t,n)}}}function H(){window.$Router=P(),$Router.path().add({"/":"views/index.html","/about":"views/about.html","/donate":"views/donate.html"}),$Router.path().add({"/feedback":"views/feedback.html"}),$Router.controller("/",function(){p(),g(),$(window).trigger("load")}),$Router.init()}function B(){}function U(t){F()}function J(){N(),$.when(A("public/version","version")).then(function(){var t=!1,e=$("#myModal"),n=Q.version;W.ICD.uk.version!=n&&(e.find("#update_db").removeClass("hidden"),t=!0),t&&function(){e.modal("show"),e.find("#loadButton").click(function(){it.start(),O().then(function(){p(),it.end()}),e.modal("hide").find("#update_lang").addClass("hidden").end().find("#update_db").addClass("hidden")})}(),it.end()},function(){z()})}function Z(){K.version?J():U()}function X(){$("li.settings").hide(),F()}function q(){L?Z():X()}function z(){N(),$(document).ready(function(){g(),it.end()})}var G,K,W,Q,Y,V,tt,et,nt,ot,at,it,rt=["%c МКХ-10 mkh10.com.ua %c Developed by KEL %c https://fb.com/kosiakMD %c\nhttp://vk.com/kosiakMD","background: #000000; color: #7EBE45","background: #000000; color: #ffffff","color: blue",""];if(window.applicationCache.addEventListener("updateready",function(t){if(window.applicationCache.status==window.applicationCache.UPDATEREADY)if(window.applicationCache.swapCache(),$("#modalTemplate").length){var e=$("#modalTemplate");e.modal(),e.find(".modal-body").text("Доступна нова версія Веб-додатку. Завантажити?"),e.find(".btn-confrim").click(function(){window.location.reload()})}else confirm("Доступна нова версія Веб-додатку. Завантажити?")&&window.location.reload()},!1),G={width1:0,width2:0,stepCatalog:0},K=localStorage,W={},Q={},Y=[],V=[],tt=[],et=[],Function.prototype.method=function(t,e){return this.prototype[t]=e},nt=Function.prototype.call.bind(Function.prototype.bind),Function.method("after",function(){var t,e,n,o,i,r;a("^ use: AFTER with NEEDS: ",arguments),t=this,e={},n={},o=function(){for(var o in e)if(!(o in n))return;t(n)};for(i=0,r=arguments.length;r>i;i++)!function(t){e[t]=function(){n[t]=arguments,o()}}(arguments[i]);return n={},e}),ot={success:function(t){},error:function(t){}},at=function(){},function(){var t,e,n;localStorage.Debugger&&JSON.parse(localStorage.Debugger)&&(t={on:!0,timer:{},id:"Debugger"},e=document.createElement("div"),e.id=t.id,e.style.maxHeight="400px",e.style.overflow="auto",e.style.padding="10px",e.style.background="whitesmoke",e.style.color="black",document.getElementsByTagName("body")[0].appendChild(e),n=document.getElementById(t.id),t.on&&(console.log=function(t){n.innerHTML+="object"==typeof t?(JSON&&JSON.stringify?JSON.stringify(t):t)+"<br>":t+"<br>"}),t.on&&(console.time=function(e){t.timer[e]=new Date}),t.on&&(console.timeEnd=function(e){var o=new Date-t.timer[e],a='<span style="color: darkred;">'+e+": "+o+" ms</span>";n.innerHTML+=a+"<br>",delete t.timer[e]}))}(),jQuery.fn.extend({manipulate:function(t){return this.each(function(){t.apply(this)})}}),it)throw Error('"preloaderXHR" is Ready Used');it={},it={div:"loadingList",counter:!1,count:0,allow:!1,add:function(t,e,n){t+=".json",it.count++,it.allow=!1,it.loadingFile(t,e,n)},change:function(t,e){3===t.readyState&&it.loadingFile(t.responseURL),4===t.readyState&&200===t.status&&(it.count--,0==it.count&&(it.allow=!0)),e&&e.apply()},check:function(t,e){return 0==it.count&&(it.allow=!0),it.allow},loadingFile:function(t,e,n){var o='<li data-file="'+e+'" >"'+t+'" завантажується...<div class="progress"><div class="progress-bar progress-bar-warning progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%">	<span class="sr-only">Loading</span>	</div></div></li>';return $("#loadingList").append(o),this},readyFile:function(t,e){$("#loadingList").find("li[data-file='"+e+"']").remove(),it.count--,it.counter&&0==it.count&&it.end()},start:function(){$("#preloader").fadeIn()},off:function(){setTimeout(function(){$("#preloader").fadeOut()},500)},end:function(){window.loaded?it.off():$(window).load(function(){it.off()})}},$("body").on("click","#selectSearchSubmit",function(){T()}).on("click","#clearStorage",function(){K.clear(),alert("Storage is cleared")}).on("click",".devMode",function(t){K.Debugger=$(this).hasClass("active")?!1:!0,window.location.reload()}).on("change",".selDisNum",function(){var t,e,n,o=[],a=$("#letter").val(),i=$("#number1a").val()+""+$("#number1b").val(),r=Q.diagnoses;for(t in r)r[t].l==a&&r[t].n1==i&&o.push(Q.diagnoses[t].n2);e=$("#number2"),e.find("option").remove(),n=document.createElement("option"),n.setAttribute("value","-"),n.innerHTML="-",e.append(n);for(t in o)n=document.createElement("option"),n.setAttribute("value",o[t]),n.innerHTML=o[t],e.append(n)}).on("change",".icd_select",function(){var t=$("#letter").val()+$("#number1a").val()+$("#number1b").val()+"."+$("#number2").val();"letter"==$(this).attr("id")&&("-"!=$(this).val()?($(".icd_select.numbers").removeAttr("disabled"),$("#selectSearchSubmit").removeAttr("disabled")):($(".icd_select.numbers").attr("disabled","disabled"),$("#selectSearchSubmit").attr("disabled","disabled"))),$("#select_code").text(t)}).on("click","#catalog-wrapper .backCatalog",function(){var t=$(this).attr("type");k(t,!0)}).on("click","#catalog-wrapper li.element",function(t){t.stopPropagation(),b.apply($(this))}).on("click","#tab_menu button",function(t){t.preventDefault(),$(this).hasClass("active")||($("#tab_menu .active").toggleClass("active"),$(this).toggleClass("active"),$("#content>.active").toggleClass("active").toggleClass("hidden-xs").toggleClass("hidden-sm"),$($(this).attr("data-id")).toggleClass("active").toggleClass("hidden-xs").toggleClass("hidden-sm"),g(),h(),m())}).on("focus","#autocomplete",function(){}).on("keypress","#autocomplete",function(t){13===t.keyCode&&($(this).blur(),$("#autocomplete").autocomplete("search"))}).on("click","#start_search",function(){$("#autocomplete").autocomplete("search")}).on("click","#clear_search",function(){$("#autocomplete").val("").autocomplete("search","")}).on("click","#changeSource button",function(){$("#changeSource .active").removeClass("active"),$(this).addClass("active");var t=$(this).attr("source");$("#autocomplete").autocomplete("option","source",Q[t])}).on("click",".changeLang",function(){}).on("click","#readNews",function(){K.readNews=!0,$("#myModal2").modal("hide")}).on("click",".iLink",function(){var t,e,n=$(this).text().match(/[A-Z][0-9]{2}\.[0-9]{1,2}|[A-Z][0-9]{2}/);n&&($("#tab_menu .btn").eq(0).click(),n=n.join("").split("."),t=n[0].match(/[A-Z]/)[0],e=n[0].match(/[0-9]{2}/)[0],$("#catalog1 .element").each(function(){var o=$(this);return t<o.attr("l2")||t<=o.attr("l2")&&e<=o.attr("n2")?(C(),"U"==t?$("#catalog1 .element").last().click():o.click(),$("#catalog2 .element").each(function(){var o=$(this);return t<o.attr("l2")||t<=o.attr("l2")&&e<=o.attr("n2")?(o.click(),$("#catalog3 .element").each(function(){var o=$(this);if(t==o.attr("l")&&e==o.attr("n1")){if(n[1])return o.click(),$("#catalog4 .element").each(function(){var t=$(this);return n[1]==t.attr("n2")?(w(t),$(":animated").promise().done(function(){y(t)}),!1):void 0}),!1;w(o),$(":animated").promise().done(function(){y(o)})}}),!1):void 0}),!1):void 0}))}),function(){a("------ Docuemnt Not Ready"),s()}(),$(document).ready(function(){a("------ Document Ready"),u(),$('[data-toggle="tooltip"]').tooltip(),$(".devMode").addClass(function(){return n(K.Debugger)?"active":""});var t=$(window).width();$(window).resize(function(){$(window).width()!=t&&(t=$(window).width(),g(),h(),k(),m())})}),window.onload=function(){a("------ Window Loaded"),window.loaded=!0,g(),L()&&"true"!==K.readNews&&$("#myModal2").modal("show")};